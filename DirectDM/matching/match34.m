(* ::Package:: *)

BeginPackage["DirectDM`"];


Begin["`Private`"]


MAT34 = ConstantArray[0,{BasisDim["3Flavor"],BasisDim["4Flavor"]}];


(* ------------------------------------------------------------------ *
 *  The off diagonal contributions
 * ------------------------------------------------------------------ *)
MAT34[[Q73[1],Q74[5,"c"]]] = -1;
MAT34[[Q73[2],Q74[6,"c"]]] = -1;
MAT34[[Q73[3],Q74[7,"c"]]] = +1;
MAT34[[Q73[4],Q74[8,"c"]]] = +1;


(* ------------------------------------------------------------------ *
 *  The 4-flavor block is diagonal
 * ------------------------------------------------------------------ *)
Do[ MAT34[[Q53[i],Q54[i]]] 			= 1, {i,2} ];
Do[ MAT34[[Q63[i,f],Q64[i,f]]] 	= 1, {i,4}, {f,flavors[3]} ];
Do[ MAT34[[Q73[i],Q74[i]]] 			= 1, {i,4} ];
Do[ MAT34[[Q73[i,f],Q74[i,f]]] 	= 1, {i,5,10}, {f,flavors[3]} ];


(* ------------------------------------------------------------------ *
 *  The matching of the twist-2 operators
 * ------------------------------------------------------------------ *)
Block[{NF},
NF = 3;
MAT34[[-1,-1]] = 1;
MAT34[[-(NF+1);;-2,-(NF+1+1);;-(2+1)]] = IdentityMatrix[NF];
]


End[]


EndPackage[]

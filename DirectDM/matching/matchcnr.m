(* ::Package:: *)

BeginPackage["DirectDM`"];


Begin["`Private`"]


(* ----------------------------------------------------------------- *
 *  Dirac fermion
 * ----------------------------------------------------------------- *)
CNRMAT/:CNRMAT["D","p"]=CNRMATp;
CNRMAT/:CNRMAT["D","n"]=CNRMATn;
CNRMATp=ConstantArray[0,{15,BasisDim["3Flavor"]}];
CNRMATn=ConstantArray[0,{15,BasisDim["3Flavor"]}];


(* ----------------------------------------------------------------- *
 *  Majorana fermion
 * ----------------------------------------------------------------- *)
CNRMAT/:CNRMAT["M","p"]=CNRMATpM;
CNRMAT/:CNRMAT["M","n"]=CNRMATnM;

LQRKS = {"u","d","s"};
NUCS  = {"p","n"};
(* ------------------------------------------------------------------ *
 *  Set the row for cNR_1
 * ------------------------------------------------------------------ *)
Block[{cnr}, cnr = 1;
	(* --------------------------------------------------------------- *)
	CNRMATp[[cnr,Q53[1]]] = -\[Alpha]emQ0 / (2 \[Pi] MX);
	CNRMATn[[cnr,Q53[1]]] = 0 (* since Qn = 0 *);
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[
		CNRMATp[[cnr,Q63[1,qq]]] = F1[qq,nn];
		CNRMATp[[cnr,Q73[5,qq]]] = FS[qq,nn];
		CNRMATp[[cnr,Q73[9,qq]]] = $NLO*(-qsq)/(2*MN*MX)*(FT0[qq,nn]-FT1[qq,nn]);
		,{qq,LQRKS}];
	CNRMATp[[cnr,Q73[1]]] = FG[nn];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[
		CNRMATn[[cnr,Q63[1,qq]]] = F1[qq,nn];
		CNRMATn[[cnr,Q73[5,qq]]] = FS[qq,nn];
		CNRMATn[[cnr,Q73[9,qq]]] = $NLO*(-qsq)/(2*MN*MX)*(FT0[qq,nn]-FT1[qq,nn]);
		,{qq,LQRKS}];
	CNRMATn[[cnr,Q73[1]]] = FG[nn];
	(* --------------------------------------------------------------- *)
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_4
 * ------------------------------------------------------------------ *)
Block[{cnr}, cnr = 4;
	(* --------------------------------------------------------------- *)
	CNRMATp[[cnr,Q53[1]]] = - 2 \[Alpha]emQ0 / \[Pi] * \[Mu]p / MN;
	CNRMATn[[cnr,Q53[1]]] = - 2 \[Alpha]emQ0 / \[Pi] * \[Mu]n / MN;
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[
		CNRMATp[[cnr,Q63[4,qq]]] = -4*FA[qq,nn];
		CNRMATp[[cnr,Q73[9,qq]]] = 8*FT0[qq,nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[
		CNRMATn[[cnr,Q63[4,qq]]] = -4*FA[qq,nn];
		CNRMATn[[cnr,Q73[9,qq]]] = 8*FT0[qq,nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_5
 * ------------------------------------------------------------------ *)
Block[{cnr}, cnr = 5;
	(* --------------------------------------------------------------- *)
	CNRMATp[[cnr,Q53[1]]] = 2 \[Alpha]emQ0 MN / ( \[Pi] * qsq );
	CNRMATn[[cnr,Q53[1]]] = 0 (* since Qn = 0 *);
	(* --------------------------------------------------------------- *)
	Do[
		CNRMATp[[cnr,Q73[9,qq]]] = $NLO*2*(FT0[qq,"p"]-FT1[qq,"p"]);
		CNRMATn[[cnr,Q73[9,qq]]] = $NLO*2*(FT0[qq,"n"]-FT1[qq,"n"]);,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_6
 * ------------------------------------------------------------------ *)
Block[{cnr,tmp,tmpp,tmpn}, cnr = 6;
	(* --------------------------------------------------------------- *)
	CNRMATp[[cnr,Q53[1]]] = MN^2(2 \[Alpha]emQ0 / ( \[Pi] * qsq ) \[Mu]p/MN);
	CNRMATn[[cnr,Q53[1]]] = MN^2(2 \[Alpha]emQ0 / ( \[Pi] * qsq ) \[Mu]n/MN);
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[
		CNRMATp[[cnr,Q63[4,qq]]] = FPp[qq,nn];
		CNRMATp[[cnr,Q73[8,qq]]] = MN/MX*FP[qq,nn];
		CNRMATp[[cnr,Q73[4]]] = MN/MX*FGt[nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[
		CNRMATn[[cnr,Q63[4,qq]]] = FPp[qq,nn];
		CNRMATn[[cnr,Q73[8,qq]]] = MN/MX*FP[qq,nn];
		CNRMATn[[cnr,Q73[4]]] = MN/MX*FGt[nn];,{qq,LQRKS}];
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_7
 * ------------------------------------------------------------------ *)
Block[{cnr}, cnr = 7;
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[CNRMATp[[cnr,Q63[3,qq]]] = - 2 FA[qq,nn],{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[CNRMATn[[cnr,Q63[3,qq]]] = - 2 FA[qq,nn],{qq,LQRKS}];
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_8
 * ------------------------------------------------------------------ *)
Block[{cnr}, cnr = 8;
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[CNRMATp[[cnr,Q63[2,qq]]] = 2 F1[qq,nn],{qq,LQRKS}];
	nn = "n";
	Do[CNRMATn[[cnr,Q63[2,qq]]] = 2 F1[qq,nn],{qq,LQRKS}];
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_9
 * ------------------------------------------------------------------ *)
Block[{cnr}, cnr = 9;
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[
		CNRMATp[[cnr,Q63[2,qq]]] = 2*(F1[qq,nn]+F2[qq,nn]);
		CNRMATp[[cnr,Q63[3,qq]]] = 2*MN/MX*FA[qq,nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[
		CNRMATn[[cnr,Q63[2,qq]]] = 2*(F1[qq,nn]+F2[qq,nn]);
		CNRMATn[[cnr,Q63[3,qq]]] = 2*MN/MX*FA[qq,nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_10
 * ------------------------------------------------------------------ *)
Block[{cnr,tmpp,tmpn}, cnr = 10;
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[
		CNRMATp[[cnr,Q73[3]]] = FGt[nn];
		CNRMATp[[cnr,Q73[7,qq]]] = FP[qq,nn];
		CNRMATp[[cnr,Q73[10,qq]]] = -2*MN/MX*FT0[qq,nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[
		CNRMATn[[cnr,Q73[3]]] = FGt[nn];
		CNRMATn[[cnr,Q73[7,qq]]] = FP[qq,nn];
		CNRMATn[[cnr,Q73[10,qq]]] = -2*MN/MX*FT0[qq,nn];,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_11
 * ------------------------------------------------------------------ *)
Block[{cnr,tmp}, cnr = 11;
	(* --------------------------------------------------------------- *)
	CNRMATp[[cnr,Q53[2]]] = 2*MN*\[Alpha]emQ0 / (\[Pi] qsq);
	CNRMATn[[cnr,Q53[2]]] = 0 (* since Qn = 0 *);
	(* --------------------------------------------------------------- *)
	nn = "p";
	Do[
		CNRMATp[[cnr,Q73[2]]] 		= -MN/MX*FG[nn];
		CNRMATp[[cnr,Q73[6,qq]]] 	= -MN/MX*FS[qq,nn];
		CNRMATp[[cnr,Q73[10,qq]]] = 2*(FT0[qq,nn]-FT1[qq,nn]);,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
	nn = "n";
	Do[
		CNRMATn[[cnr,Q73[2]]] 		= -MN/MX*FG[nn];
		CNRMATn[[cnr,Q73[6,qq]]] 	= -MN/MX*FS[qq,nn];
		CNRMATn[[cnr,Q73[10,qq]]] = 2*(FT0[qq,nn]-FT1[qq,nn]);,{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
]


(* ------------------------------------------------------------------ *
 *  Set the row for cNR_12
 * ------------------------------------------------------------------ *)
Block[{cnr,tmp}, cnr = 12;
	(* --------------------------------------------------------------- *)
	Do[CNRMATp[[cnr,Q73[10,qq]]] = -8*FT0[qq,"p"],{qq,LQRKS}];
	Do[CNRMATn[[cnr,Q73[10,qq]]] = -8*FT0[qq,"n"],{qq,LQRKS}];
	(* --------------------------------------------------------------- *)
]


(* ----------------------------------------------------------------- *
 *  Majorana fermion: copy matrix of complex scalar since coefficients
 *  	are already set correctly
 * ----------------------------------------------------------------- *)
CNRMATpM = CNRMATp;
CNRMATnM = CNRMATn;


End[]


EndPackage[]
